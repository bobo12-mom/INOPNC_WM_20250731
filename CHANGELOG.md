# CHANGELOG

## [2025-08-03] - 모바일 UX 최적화를 위한 용어 간소화

### 🎨 UI/UX 개선
- **용어 간소화**: 모바일 기기에서의 가독성 향상을 위한 인터페이스 텍스트 간소화
  - "T맵지도" → "T맵" (현장정보의 네비게이션 링크)
  - "공사도면" → "도면" (작업 상세정보 옆 버튼 및 모달 제목)
  - "공도면" → "도면" (빠른메뉴 항목명)

### 📱 모바일 최적화
- **홈 화면 큰글씨 모드**: 더 간결한 용어로 모바일 사용성 개선
- **일관성 향상**: 전체 인터페이스에서 통일된 용어 사용
- **가독성 개선**: 짧은 용어로 터치 버튼의 가독성 향상

### 📋 파일 변경사항
- `components/site-info/TodaySiteInfo.tsx`: T맵 링크 및 도면 관련 용어 업데이트
- `components/dashboard/tabs/home-tab.tsx`: 빠른메뉴 항목명 업데이트
- `PRD.md`: 제품 요구사항 문서 용어 업데이트

## [2025-08-03] - 급여정보 UI 개선 및 네비게이션 접근성 향상

### ✨ 새로운 기능
- **급여 계산식 표시**: 급여정보 탭에 상세한 계산 공식 추가
  - 기본급 + 연장수당 + 제수당 - 공제액 = 실지급액 단계별 표시
  - 근무일 기준 일당/시급 평균 계산 및 표시
  - 시각적 계산 과정 (색상 코딩 및 구분선)
  - 투명한 급여 계산 과정으로 사용자 이해도 향상

### 🎨 UI/UX 개선
- **급여정보 탭 Compact 디자인**
  - 기존 카드 형태 → 테이블 형태로 변경
  - 핵심 정보만 표시: 월, 현장, 근무일, 기본급, 연장수당, 실지급액
  - 금액 단위 간소화: 원 → 만원 단위 표시
  - 현장명 자동 축약으로 공간 효율성 증대
  - 하단 상세 영역에 최근 월 급여 내역 표시

- **네비게이션 시스템 개선**
  - URL 기반 activeTab 관리 시스템 구현
  - 브라우저 뒤로가기/앞으로가기 버튼 지원
  - 직접 URL 접근 시 올바른 탭 활성화
  - 페이지 새로고침 시 탭 상태 유지

### ♿ 접근성 개선
- **ARIA 표준 준수**
  - `aria-hidden` → `inert` 속성 사용으로 접근성 경고 해결
  - 모바일 사이드바 닫힌 상태에서 포커스 차단
  - 스크린 리더 지원 향상
  - 키보드 네비게이션 개선

### 🛠 기술적 구현
- **DashboardLayout 개선**
  - `usePathname` 훅을 통한 URL 감지
  - `useEffect`로 경로 변경 시 자동 탭 업데이트
  - site-info 페이지 하드코딩 제거

- **Sidebar 컴포넌트 최적화**
  - 불필요한 import 제거 및 코드 정리
  - TypeScript 타입 오류 수정

### 🐛 버그 수정
- **site-info 페이지 네비게이션 문제 해결**
  - 다른 사이드바 메뉴 클릭 시 이동 불가 문제 수정
  - 하드코딩된 activeTab 제거로 정상적인 네비게이션 복원

## [2025-08-03] - 오늘의 현장 정보 섹션 기능 확장

### ✨ 새로운 기능
- **공사도면 보기 기능**: 작업 구간의 실제 건설 도면을 확인할 수 있는 기능 추가
  - 작업 정보 옆에 "공사도면" 버튼 배치
  - 모달 창에서 실제 도면 이미지 표시
  - 도면 다운로드 기능 구현
  - 샘플 도면 파일: `/docs/샘플도면5.png`

- **PTW(작업허가서) 문서 기능**: 작업허가서 문서를 미리보고 다운로드할 수 있는 기능 추가
  - 작업 정보 하단에 "PTW (작업허가서)" 섹션 추가
  - 미리보기 버튼으로 PDF 문서 표시
  - 자동 생성된 문서 번호 (PTW-2025-[site-id])
  - PDF 다운로드 기능 구현
  - PTW 문서 파일: `/docs/[양식]PTW양식_이노피앤씨.pdf`

### 🎨 UI/UX 개선
- **모바일 최적화 모달**
  - 모바일: 하단에서 슬라이드업 애니메이션
  - 데스크탑: 중앙 정렬 표시
  - 반응형 버튼 크기 및 레이아웃
  
- **모달 디자인 개선**
  - 다크 모드 완벽 지원
  - 부드러운 전환 효과
  - 터치 친화적인 버튼 크기 (최소 44x44px)
  - NavBar와 겹치지 않도록 z-index 조정 (z-[100])

### 🛠 기술적 구현
- **컴포넌트 업데이트**: `TodaySiteInfo.tsx` 컴포넌트 확장
  - 새로운 상태 관리: `showBlueprintModal`, `showPTWModal`
  - 파일 다운로드 로직 구현
  - iframe을 통한 PDF 미리보기
  
- **애니메이션 개선**: Tailwind 설정 업데이트
  - `slideUp` 애니메이션을 모바일 친화적으로 수정
  - 100% 위치에서 0%로 이동하는 자연스러운 효과

### 📚 문서 업데이트
- **PRD.md**: 오늘의 현장 정보 섹션 스펙 업데이트
- **CLAUDE.md**: Recent Updates 섹션 추가
- **README.md**: 현장정보 관리 시스템 섹션 추가

## [2025-08-02] - UI 개선 및 기능 구현

### ✅ 완료된 기능
- 전체 섹션 한번에 접기/펼치기 토글 (헤더 우상단)
- '진행률' → '작성 진행률' 용어 변경
- 컴팩트 UI 디자인 (모든 섹션)
- 작업자 입력 섹션 3열 그리드 레이아웃 (작업자 2/3 + 공수 1/3)
- 작업자 헤더에 번호 표시 (작업자 1, 작업자 2...)
- 모바일 최적화 터치 타겟 (최소 44px)
- React controlled/uncontrolled input 오류 완전 해결
- NotificationDropdown import 오류 수정
- useEffect 무한 루프 오류 해결
- Next.js 서버 충돌 및 404 오류 해결
- 컴팩트 카드 레이아웃
- 2x2 통계 그리드
- 검색 인터페이스 통합
- 모바일 최적화 간격

## [2025-08-01] - 현장 정보 시스템 구현 및 실제 DB 연동

### ✨ 새로운 기능
- **현장 정보 실시간 표시**: 로그인한 사용자의 현재 배정된 현장 정보를 실제 데이터베이스에서 조회
  - 현장 주소, 숙소 주소, 작업공정, 작업구간, 부재명 정보 표시
  - 건축 담당자 및 안전 담당자 연락처 표시
  - 주소 복사, T-Map 연결, 전화걸기 기능 지원
- **현장 참여 이력**: 사용자가 그동안 참여했던 모든 현장 이력 표시
  - 현장별 참여 기간, 역할, 상태 정보 표시
  - 현재 활성 현장과 과거 현장 구분 표시
  - 스크롤 가능한 컴팩트 리스트 형태로 구현

### 🛠 기술적 개선
- **데이터베이스 스키마 확장**: Sites 테이블에 상세 현장 정보 컬럼 추가
  - work_process, work_section, component_name (작업 정보)
  - manager_name, safety_manager_name (담당자 정보)
  - site_assignments 테이블에 role 컬럼 추가
- **서버 액션 구현**: 현장 정보 조회를 위한 전용 서버 액션
  - getCurrentUserSite(): 현재 사용자 배정 현장 조회
  - getUserSiteHistory(): 사용자 현장 참여 이력 조회
  - 관리자용 현장 관리 기능 (assignUserToSite, getAllSites 등)
- **PostgreSQL 함수 및 뷰**: 효율적인 데이터 조회를 위한 DB 함수
  - get_current_user_site(): 현재 사용자 현장 정보 조회
  - get_user_site_history(): 사용자 현장 이력 조회
  - current_site_assignments 뷰: 활성 현장 배정 조회 최적화
- **TypeScript 타입 정의**: 현장 정보 관련 완전한 타입 시스템
  - CurrentUserSite, UserSiteHistory, SiteAssignment 인터페이스
  - SiteAssignmentRole 타입 정의

### 🔄 UI 개선  
- **로딩 상태 표시**: 현장 정보 로딩 중 스피너 및 상태 메시지
- **에러 처리**: 데이터 로딩 실패 시 에러 메시지 및 재시도 기능
- **빈 상태 처리**: 배정된 현장이 없을 때 안내 메시지 표시
- **조건부 렌더링**: 데이터 존재 여부에 따른 섹션별 조건부 표시
- **반응형 디자인**: 모바일 친화적 현장 이력 리스트 구현

### 📊 데이터 구조
- **확장된 Sites 테이블**: 상세 현장 정보 저장
- **개선된 Site Assignments**: 역할 기반 현장 배정 관리
- **성능 최적화**: 인덱스 및 뷰를 통한 쿼리 성능 향상
- **샘플 데이터**: 개발/테스트용 현장 정보 데이터 추가

### 🎯 사용자 경험
- **실시간 정보**: Mock 데이터에서 실제 DB 데이터로 완전 전환
- **직관적 인터페이스**: 현장 정보와 이력을 명확히 구분하여 표시
- **빠른 액세스**: 주소 복사, 길찾기, 전화걸기 원클릭 기능
- **컴팩트 표시**: 공간 효율적인 현장 이력 표시

## [2025-08-01] - 홈 탭 개선 및 빠른 메뉴 설정 기능 구현

### ✨ 새로운 기능
- **빠른 메뉴 커스터마이징**: 사용자가 홈 화면 빠른 메뉴를 자유롭게 설정할 수 있는 기능 추가
  - 12개 메뉴 항목 중 최대 8개 선택 가능
  - 설정 모달을 통한 직관적인 선택 인터페이스
  - localStorage를 통한 설정 저장 및 복원
  - 각 메뉴별 고유 아이콘과 색상 코딩

### 🔄 UI 개선
- **홈 탭 간소화**: 불필요한 대시보드 카드 및 웰컴 섹션 제거
  - "안녕하세요, Site Manager님" 섹션 제거
  - 4개 통계 카드 (작업일지, 승인대기, 활성작업자, 새알림) 제거
  - "추가" 카드 제거로 깔끔한 레이아웃 구현

### 🎨 사용자 경험 개선
- **개인화된 대시보드**: 사용자별 맞춤 빠른 메뉴 구성
- **직관적인 설정**: 체크박스 기반 선택 UI
- **시각적 피드백**: 선택/해제 상태의 명확한 표시
- **반응형 디자인**: 모바일 친화적 2열 그리드 레이아웃

### 📋 사용 가능한 빠른 메뉴
1. 출근현황 - 근무 현황 확인
2. 내문서함 - 개인 문서 관리
3. 현장정보 - 현장 세부 정보
4. 공도면 - 공유 도면 및 문서
5. 작업일지 - 일일 작업 보고서
6. 작업자관리 - 작업자 정보 관리
7. 통계현황 - 작업 통계 및 분석
8. 자재관리 - 자재 현황 및 관리
9. 안전관리 - 안전 점검 및 관리
10. 알림 - 알림 및 메시지
11. 업무목록 - 할 일 및 업무 관리
12. 메시지 - 메시지 및 소통

### 🛠 기술적 개선
- **상태 관리**: React hooks 기반 설정 상태 관리
- **데이터 지속성**: localStorage 기반 사용자 설정 저장
- **타입 안전성**: TypeScript 인터페이스 정의
- **컴포넌트 최적화**: 불필요한 import 및 코드 제거

## [2025-08-01] - UI 개선 및 기능 구현

### ✅ 완료된 기능
- 전체 섹션 한번에 접기/펼치기 토글 (헤더 우상단)
- '진행률' → '작성 진행률' 용어 변경
- 컴팩트 UI 디자인 (모든 섹션)
- 작업자 입력 섹션 3열 그리드 레이아웃 (작업자 2/3 + 공수 1/3)
- 작업자 헤더에 번호 표시 (작업자 1, 작업자 2...)
- 모바일 최적화 터치 타겟 (최소 44px)
- React controlled/uncontrolled input 오류 완전 해결
- NotificationDropdown import 오류 수정
- useEffect 무한 루프 오류 해결
- Next.js 서버 충돌 및 404 오류 해결
- 컴팩트 카드 레이아웃
- 2x2 통계 그리드
- 검색 인터페이스 통합
- 모바일 최적화 간격

